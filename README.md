# Обнаружение рака кожи на основе глубокого обучения и энтропии для выявления выбросов

За основу взял работу из https://medium.com/swlh/deep-learning-predicting-skin-cancer-379084c33573
Провел небольшую подготовку картинок по уменьешению их размеров, чтобы google colab справилась с обработкой в keras.

Целью задачи является обеспечение диагностики рака кожи с использованием изображений. В отобранном из ISIC наборе данных есть два 2 класса. Для определения использовались сверточные нейронные сети. Получившиеся результаты показали хорошее качество работы модели - val_acc = 0.94

### Вступление
Заболеваемость раком кожи увеличивалается на протяжении последних десятилетий. По оценкам Всемирной организации здравоохранения (ВОЗ), ежегодно во всем мире происходит около 3 миллионов случаев рака кожи.
Использование систем компьютерной диагностики (CAD) для выявления рака кожи расширяется в течение последнего десятилетия. В последнее время модели глубокого обучения достигли замечательных результатов в различных задачах анализа медицинских изображений. В частности, сверточные нейронные сети (CNN) стали стандартным подходом для решения такого рода проблем.

Прогресс в значительной степени обусловлен Международным сотрудничеством по визуализации кожи (ISIC), которое предоставляет исследовательскому сообществу большой набор данных по раку кожи.
В этом отчете будет показан пример решения задачи определения рака на основе двух известных классов из данных ISIC. Будет описана используемая модель, данные и достигнутые результаты.

### Датасет
С целью поддержки клинического обучения и дальнейших технических исследований, которые в конечном итоге приведут к автоматическому алгоритмическому анализу, Международное сотрудничество по визуализации кожи (ISIC) разработало международный репозиторий дермоскопических изображений, известный как архив ISIC. Каждый год ISIC увеличивает свой архив и продвигает задачу по использованию автоматического обнаружения рака кожи. В 2019 году количество образцов насчитывало 25,331 изображений для дермоскопии, доступных для обучения в 8 различных категориях. Тренировочный набор данных состоит из 1,255 изображений, а тестовый из 400 значений. 

### Принципы работы модели
Сверточная нейронная сеть (CNN) - это алгоритм глубокого обучения, который берет входное изображение, назначает изучаемые веса и смещения различным функциям и объектам в изображении, а затем способен отличать один от других. 
4 основных шага по созданию CNN:

Шаг 1 - свертка:
Функция, полученная из двух данных функций путем интегрирования, которая выражает, как форма одного изменяется другим. Создается карта объектов, которая содержит аргументы, записанные фильтром для входного изображения. Значение из входного изображения первоначально вставляется в верхнюю левую ячейку карты объектов и перемещает блок вправо, записывая наблюдение за каждым шагом.

Шаг 2 - Максимальный пулинг:
Цель максимального пула состоит в том, чтобы позволить CNN обнаруживать изображение, когда оно представлено с базовой модификацией (например перевернутым или отображенным зеркально). На этом этапе мы определяем объединенную карту объектов. Максимальный пулинг занимается обучением сверточной нейронной сети распознавать, что, несмотря на все эти различия, все они представляют собой одно и то же. Для этого сети необходимо приобрести свойство, известное как «пространственная дисперсия», поэтому она может распознавать объект на изображении, даже если он пространственно отличается от другого изображения того же объекта. Существуют также другие методы объединения, такие как «Среднее объединение» и «Суммирование пула».

Шаг 3 - Сглаживание:
К этому моменту уже есть объединенная карта объектов. На этом шаге происходит ее выравнивание в форму вертикального столбца. После сглаживания получается длинный вектор входных данных, который затем передается нейронной сети для дальнейшей обработки, иначе ей было бы трудно читать эти данные.

Шаг 4 - Полное соединение:
Полностью связанный слой в СНН аналогичен скрытому слою в ИНН. Роль искусственной нейронной сети состоит в том, чтобы собирать эти данные и объединять функции в более широкий спектр атрибутов, которые делают сверточную сеть более способной к классификации изображений.

### Построение модели и вычисления
1. Сначала, классификатор CNN прикрепляется к классу Sequential, чтобы инициализировать модель CNN в виде последовательности слоев. 
2. Далее, добавляется слой свертки Convolution 2D, с параметрами: 32 -это числу детекторов функций. По умолчанию это значение равно 64. Второй и третий параметры относятся к размерам детекторов признаков, которые будут представлять собой матрицу 3 x 3.
Форма ввода в третьем параметре преобразует все изображения в размер в 32 x 32 пикселя, где 3  - это количество цветовых каналов RGB.
Последний параметр - это функция активации, которую мы используем для активации нейронов в нейронной сети, например 'relu'. 
3. В третьем шаге используется пулинг (MaxPooling2D) с картой (3x3), в отличие от автора статьи, у которого (2Х2).
4. Затем проводится сглаживание функцией Flatten
5. В последнем шаге строится полностью связанный слой, который похож на скрытые слои. Функция Dense имеет 2 параметра -  количество узлов для выходного слоя(128) и функция активации, которая снова будет 'relu'. Выходной слой имеет 1 узел, игде сипользуется функция активации сигмоида (потому что предсказывает - или 1).

Модель CNN нужно скомпилировать и оптимизировать весовые коэффициенты и функцию потерь для оценки модели. 
* Оптимизатор 'adam' который является алгоритмом стохастического градиентного спуска.
* Функция потерь, которая будет binary_crossentropy, поскольку мы предсказывается двоичная переменная (1 или 0; Доброкачественная или Злокачественная).
• Функция метрик, которая будет оценивать точность модели. Например accuracy , которая достигается путем деления истинных прогнозов на общие прогнозы.

ДЛя фиттинга модели на данных используется класс ImageDataGenerator 
